var Sudoku=function(a){function b(b){return conf=a.extend({},g,b),f=new c(conf),{getGameBoard:function(){return f.buildGUI()},reset:function(){f.resetGame()},validate:function(){var b;b=f.validateMatrix(),a(".sudoku-container").toggleClass("valid-matrix",b)},solve:function(){var b,c,d,e;return f.validateMatrix()?(f.recursionCounter=0,f.backtrackCounter=0,c=Date.now(),b=f.solveGame(0,0),d=Date.now(),a(".sudoku-container").toggleClass("valid-matrix",b),b&&a(".valid-matrix input").attr("disabled","disabled"),f.config.show_solver_timer&&(e=d-c,window.console.log("Solver elapsed time: "+e+"ms")),void(f.config.show_recursion_counter&&(window.console.log("Solver recursions: "+f.recursionCounter),window.console.log("Solver backtracks: "+f.backtrackCounter)))):!1}}}function c(a){return this.config=a,this.recursionCounter=0,this.$cellMatrix={},this.matrix={},this.validation={},this.resetValidationMatrices(),this}function d(a,b){return Math.floor(Math.random()*(b+1))+a}var e,f,g={validate_on_insert:!0,show_solver_timer:!0,show_recursion_counter:!0,solver_shuffle_numbers:!0,difficulty_level:"easy"};return c.prototype={buildGUI:function(){for(var b,c,e,f,g,h,i=a("<table>").addClass("sudoku-container table table-bordered"),j=this.config.difficulty_level.toString(),k={easier:["040730800007090305036480000210500000000000000000008012000074280604050700008013090","502001009100000040000485007000009078069000450470300000300974000090000001700600504","040031069007000045030400000200000670800000003075000002000004080690000700720610090","400000062000004001002509040304000500200806007005000206040608100500200000920000008","000300902600004001180000740000100089000856000870003000043000025500200004906005000","050000080410097000006050903000000092395208471640000000501020800000910057030000020","000400070170900082600500040000049300900356008006270000060005001810004029090002000"],easy:["057081002030000000000500040304070580290000037075040206040008000000000090900410370","000000002609704000082500043300002500000806000005900006740008120000207604900000000","500030000210004300034700800743060002009020500800070634008009250005300091000050008","502001000000000040030080007200009078800107003470300002300070080090000000000600504","000001809187090300906480007010009000009020400000300010300074206004050731708600000","500700009000200340000005120010040608009000400405060010051900000094002000700003004","000700860100200040000485000003009670009000400075300900000974000090002001028003000","007000060630000801080500000004070589001050400875040200000008020508000094020000300"],medium:["002001060000206300000085107210509000060000050000308012301970000004802000020600500","002700000000000045900085007210540000000020000000068012300970006690000000000003500","000301060630020850002500040300000500290000037005000006040008100018030094020405000","200600704003800060080052000100045000090000070000170008000720040020006300907004006","003006040040307001897200000070000003031000470500000010000008257300705090080900300","040000091500001002000040700012008000900030005000900120009080000600300004250000060","000900370000052006913007000800000600050030010009000003000100782100580000086009000","000040000956000000000010079085400700340050062002001450820060000000000185000090000","300040600002390100650010070006000740000060000025000900040030015007051300003020007"],hard:["000006072000007650620005890000080040006203900080070000069400027042700000750900000","080040600072090000609210000006000042730000081820000900000037205000050390003020060","600000008750004000002670000491500000080030040000008157000042700000800034900000002","040000008000080001802005090000507380007000200026408000030900705200060000900000010","050600000000090205706000000170345602300060001602179038000000809804010000000004020","000500610001800004060000598100008060506020801090600003974000050600005400085009000","008500090500004703006903004001600800000080000003001400200305600307100002050006300","408007090000800700000000504001030005700409006600050400209000000007008000050200307","000000002050803070002560010305100700000070000004005209040052100090608030500000000"],harder:["806700090000000004000500813005190008000204000700085200643002000200000000080007906","005300709092000500000007060003609008000204000900105400060400000004000920508002300","008560090092800060100003000901600070000000000080001409000300008060008950050096300","020039040905070036430000007000200300000050000002007000800000064740080502050790010","100650409002007000000100080009008060200305008040900500080006000000500700605079004","080020304340000009000400570900600800051090740004007002015004000700000085408070090","080040609072000108000008070100503000000962000000104006040600000207000390503020060","050301062000700050180009043060002009000050000800900010740600025010007000920405070","003200570000080001002005003490500006507000209300008057100900700200060000064003800"],extreme:["500001060080206040000000107013009008000127000400300910301000000090802030020600004","000700069000006300000085120010000608009020400405000010051970000004800000720003000","807520000000000402000049050002000940900030005085000100030280000601000000000017309","000600109000000070030705020700060002060423080800070004070109050020000000301007000","007009100000400030000062900089000370104000609062000480001320000040001000006700800","000000100010070006008062050009006001000803000300900400090320700700080090006000000","600000000010070036000100957089206000000050000000907480891005000740080090000000003","000700620400090050009008070090080740000060000025070030040600200060050004013009000"]};void 0===k[j][e];)e=d(0,9);e=k[j][e].toString(),f=e.match(/.{1,9}/g);for(var l=0;9>l;l++){c=a("<tr>"),this.$cellMatrix[l]={},g=f[l];for(var m=0;9>m;m++)this.$cellMatrix[l][m]=a("<input>").attr("maxlength",1).addClass("form-control").data("row",l).data("col",m).on("keyup",a.proxy(this.onKeyUp,this)),h=parseFloat(g.charAt(m)),0!==h&&this.$cellMatrix[l][m].val(h),b=a("<td>").append(this.$cellMatrix[l][m]),sectIDi=Math.floor(l/3),sectIDj=Math.floor(m/3),b.addClass((sectIDi+sectIDj)%2===0?"sudoku-section-one":"sudoku-section-two"),c.append(b);i.append(c)}return i},onKeyUp:function(b){var c,d,e,f=!0,g=a.trim(a(b.currentTarget).val()),h=a(b.currentTarget).data("row"),i=a(b.currentTarget).data("col");a(".sudoku-container").removeClass("valid-matrix"),this.config.validate_on_insert&&(f=this.validateNumber(g,h,i,this.matrix.row[h][i]),a(b.currentTarget).toggleClass("sudoku-input-error",!f)),c=Math.floor(h/3),d=Math.floor(i/3),e=h%3*3+i%3,this.matrix.row[h][i]=g,this.matrix.col[i][h]=g,this.matrix.sect[c][d][e]=g},resetGame:function(){this.resetValidationMatrices();for(var b=0;9>b;b++)for(var c=0;9>c;c++)this.$cellMatrix[b][c].val("");a(".sudoku-container input").removeAttr("disabled"),a(".sudoku-container").removeClass("valid-matrix")},resetValidationMatrices:function(){this.matrix={row:{},col:{},sect:{}},this.validation={row:{},col:{},sect:{}};for(var a=0;9>a;a++)this.matrix.row[a]=["","","","","","","","",""],this.matrix.col[a]=["","","","","","","","",""],this.validation.row[a]=[],this.validation.col[a]=[];for(var b=0;3>b;b++){this.matrix.sect[b]=[],this.validation.sect[b]={};for(var c=0;3>c;c++)this.matrix.sect[b][c]=["","","","","","","","",""],this.validation.sect[b][c]=[]}},validateNumber:function(b,c,d,e){var f=!0,g=Math.floor(c/3),h=Math.floor(d/3);return e=e||"",this.validation.row[c].indexOf(e)>-1&&this.validation.row[c].splice(this.validation.row[c].indexOf(e),1),this.validation.col[d].indexOf(e)>-1&&this.validation.col[d].splice(this.validation.col[d].indexOf(e),1),this.validation.sect[g][h].indexOf(e)>-1&&this.validation.sect[g][h].splice(this.validation.sect[g][h].indexOf(e),1),""!==b&&(a.isNumeric(b)&&Number(b)>0&&Number(b)<=9&&(f=a.inArray(b,this.validation.row[c])>-1||a.inArray(b,this.validation.col[d])>-1||a.inArray(b,this.validation.sect[g][h])>-1?!1:!0),this.validation.row[c].push(b),this.validation.col[d].push(b),this.validation.sect[g][h].push(b)),f},validateMatrix:function(){for(var a,b,c=!1,d=0;9>d;d++)for(var e=0;9>e;e++)b=this.matrix.row[d][e],a=this.validateNumber(b,d,e,b),this.$cellMatrix[d][e].toggleClass("sudoku-input-error",!a),a||(c=!0);return!c},solveGame:function(a,b){var c,d,e,f,g,h,i,j;if(this.recursionCounter++,f=this.findClosestEmptySquare(a,b)){d=f.data("row"),e=f.data("col"),g=this.findLegalValuesForSquare(d,e),h=Math.floor(d/3),i=Math.floor(e/3),j=d%3*3+e%3;for(var k=0;k<g.length;k++){if(c=g[k],f.val(c),this.matrix.row[d][e]=c,this.matrix.col[e][d]=c,this.matrix.sect[h][i][j]=c,this.solveGame(d,e))return!0;this.backtrackCounter++,this.$cellMatrix[d][e].val(""),this.matrix.row[d][e]="",this.matrix.col[e][d]="",this.matrix.sect[h][i][j]=""}return!1}return!0},findClosestEmptySquare:function(a,b){for(var c,d,e=!1,f=b+9*a;81>f;f++)if(c=Math.floor(f/9),d=f%9,""===this.matrix.row[c][d])return e=!0,this.$cellMatrix[c][d]},findLegalValuesForSquare:function(a,b){var c,e,f,g=Math.floor(a/3),h=Math.floor(b/3);for(c=[1,2,3,4,5,6,7,8,9],f=0;9>f;f++)e=Number(this.matrix.col[b][f]),e>0&&c.indexOf(e)>-1&&c.splice(c.indexOf(e),1);for(f=0;9>f;f++)e=Number(this.matrix.row[a][f]),e>0&&c.indexOf(e)>-1&&c.splice(c.indexOf(e),1);for(g=Math.floor(a/3),h=Math.floor(b/3),f=0;9>f;f++)e=Number(this.matrix.sect[g][h][f]),e>0&&c.indexOf(e)>-1&&c.splice(c.indexOf(e),1);if(this.config.solver_shuffle_numbers)for(f=c.length-1;f>0;f--){var i=d(0,f);temp=c[f],c[f]=c[i],c[i]=temp}return c}},{getInstance:function(a){return e||(e=b(a)),e}}}(jQuery);